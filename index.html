<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>LED Calculator</title>
        <style>
            body {
                font-family: sans-serif;
                padding: 20px;
            }

            .input-section {
                margin-bottom: 20px;
            }

            .canvas-container {
                width: auto;
                max-width: 800px;
                margin-top: 20px;
            }

            canvas {
                width: auto;
                height: auto;
                background: #fff;
                display: block;
            }

            .info {
                margin-top: 20px;
            }
        </style>
    </head>
    <body>
        <h2>LED Calculator</h2>

        <div class="input-section">
            <label>Lebar LED (W) dalam meter: <input type="number" id="inputW" step="0.01" /></label><br /><br />
            <label>Tinggi LED (H) dalam meter: <input type="number" id="inputH" step="0.01" /></label><br /><br />
            <label for="pitch">
                Pitch LED
                <select id="pitch">
                    <option value="2.604">P2.6 (2.604 mm)</option>
                    <option value="2.976">P2.9 (2.976 mm)</option>
                    <option value="3.91">P3.9 (3.91 mm)</option>
                </select>
            </label>
            <br /><br />
            <button onclick="hitungDanGambar()">Hitung dan Tampilkan</button>
        </div>

        <div class="canvas-container">
            <canvas id="ledCanvas"></canvas>
        </div>

        <div id="info" class="info"></div>

        <script>
            function hitungDanGambar() {
                const W = parseFloat(document.getElementById("inputW").value);
                const H = parseFloat(document.getElementById("inputH").value);
                const pitch = parseFloat(document.getElementById("pitch").value);

                if (!W || !H || W <= 0 || H <= 0) {
                    alert("Masukkan nilai W dan H yang valid.");
                    return;
                }

                const canvas = document.getElementById("ledCanvas");
                const ctx = canvas.getContext("2d");

                const maxCanvasSize = 800;
                const isHorizontal = W >= H;

                let canvasWidth, canvasHeight;
                if (isHorizontal) {
                    canvasWidth = maxCanvasSize;
                    canvasHeight = (H / W) * canvasWidth;
                } else {
                    canvasHeight = 600;
                    canvasWidth = (W / H) * canvasHeight;
                }

                canvas.width = canvasWidth;
                canvas.height = canvasHeight;

                ctx.clearRect(0, 0, canvas.width, canvas.height);

                let kontenWidth = (16 / 9) * H;
                let kontenHeight = H;
                let sisaX = (W - kontenWidth) / 2;
                let sisaY = 0;

                if (kontenWidth > W) {
                    kontenWidth = W;
                    kontenHeight = (9 / 16) * W;
                    sisaX = 0;
                    sisaY = (H - kontenHeight) / 2;
                }

                const pixelW = Math.round((W * 1000) / pitch);
                const pixelH = Math.round((H * 1000) / pitch);
                const pixelKontenW = Math.round((kontenWidth * 1000) / pitch);
                const pixelKontenH = Math.round((kontenHeight * 1000) / pitch);

                const padding = 40;
                const scaleX = (canvas.width - 2 * padding) / W;
                const scaleY = (canvas.height - 2 * padding) / H;
                const scale = Math.min(scaleX, scaleY);
                const boxW = W * scale;
                const boxH = H * scale;
                const innerW = kontenWidth * scale;
                const innerH = kontenHeight * scale;
                const offsetX = padding + sisaX * scale;
                const offsetY = padding + sisaY * scale;

                ctx.fillStyle = "#ffffff";
                ctx.fillRect(padding, padding, boxW, boxH);
                ctx.strokeStyle = "#000";
                ctx.lineWidth = 4;
                ctx.strokeRect(padding - 2, padding - 2, boxW + 4, boxH + 4);

                ctx.fillStyle = "#29a8e0";
                ctx.fillRect(offsetX, offsetY, innerW, innerH);

                ctx.strokeStyle = "white";
                ctx.setLineDash([5, 5]);
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(offsetX, offsetY);
                ctx.lineTo(offsetX + innerW, offsetY + innerH);
                ctx.moveTo(offsetX + innerW, offsetY);
                ctx.lineTo(offsetX, offsetY + innerH);
                ctx.stroke();
                ctx.setLineDash([]);

                const textLines = ["Konten 16:9", `${kontenWidth.toFixed(2)} m x ${kontenHeight.toFixed(2)} m`, `${pixelKontenW} px x ${pixelKontenH} px`];

                ctx.font = "12px sans-serif";
                ctx.textAlign = "center"; // Pastikan teks di tengah secara horizontal
                const textHeight = 14; // Tinggi per baris teks
                const totalTextHeight = textLines.length * textHeight; // Total tinggi teks

                // Menghitung posisi X dan Y untuk memastikan teks berada di tengah
                const textX = offsetX + innerW / 2; // Posisi X di tengah konten biru
                const textY = offsetY + innerH / 2 - totalTextHeight / 2 + textHeight / 2; // Posisi Y di tengah vertikal konten biru

                // Mengatur lebar background biru berdasarkan ukuran teks
                const textWidth = Math.max(...textLines.map((line) => ctx.measureText(line).width)); // Mengambil lebar teks terpanjang
                const backgroundWidth = textWidth + 20; // Menambahkan sedikit padding
                const backgroundHeight = totalTextHeight + 10; // Menambahkan sedikit padding

                // Gambar background biru untuk teks
                ctx.fillStyle = "#29a8e0";
                ctx.fillRect(textX - backgroundWidth / 2, textY - textHeight / 2 - 5, backgroundWidth, backgroundHeight);

                // Gambar teks di atas background biru
                ctx.fillStyle = "#fff";
                for (let i = 0; i < textLines.length; i++) {
                    ctx.fillText(textLines[i], textX, textY + i * textHeight + 3);
                }

                ctx.fillStyle = "#000";
                ctx.font = "12px sans-serif";

                if (sisaX > 0) {
                    const arrowY = padding - 10;
                    const arrowStartX = offsetX - sisaX * scale;
                    const arrowEndX = offsetX;

                    ctx.beginPath();
                    ctx.moveTo(arrowStartX, arrowY);
                    ctx.lineTo(arrowEndX, arrowY);
                    ctx.strokeStyle = "red";
                    ctx.lineWidth = 1;
                    ctx.stroke();

                    ctx.beginPath();
                    ctx.moveTo(arrowStartX, arrowY - 3);
                    ctx.lineTo(arrowStartX, arrowY + 3);
                    ctx.moveTo(arrowEndX, arrowY - 3);
                    ctx.lineTo(arrowEndX, arrowY + 3);
                    ctx.stroke();

                    ctx.fillText(`Sisa ${sisaX.toFixed(2)} m`, (arrowStartX + arrowEndX) / 2, arrowY - 5);
                }

                if (sisaY > 0) {
                    const arrowX = padding - 10;
                    const arrowStartY = offsetY - sisaY * scale;
                    const arrowEndY = offsetY;

                    ctx.beginPath();
                    ctx.moveTo(arrowX, arrowStartY);
                    ctx.lineTo(arrowX, arrowEndY);
                    ctx.strokeStyle = "red";
                    ctx.lineWidth = 1;
                    ctx.stroke();

                    ctx.beginPath();
                    ctx.moveTo(arrowX - 3, arrowStartY);
                    ctx.lineTo(arrowX + 3, arrowStartY);
                    ctx.moveTo(arrowX - 3, arrowEndY);
                    ctx.lineTo(arrowX + 3, arrowEndY);
                    ctx.stroke();

                    ctx.save();
                    ctx.translate(padding - 15, (arrowStartY + arrowEndY) / 2); // pindahkan ke kiri kotak
                    ctx.rotate(-Math.PI / 2);
                    ctx.fillText(`Sisa ${sisaY.toFixed(2)} m`, 0, 0);
                    ctx.restore();
                }
                ctx.font = "16px sans-serif";
                ctx.fillText(`W: ${W.toFixed(2)} m / ${pixelW} px`, padding + boxW / 2, padding + boxH + 25);
                ctx.save();
                ctx.translate(padding + boxW + 25, padding + boxH / 2);
                ctx.rotate(-Math.PI / 2);
                ctx.fillText(`H: ${H.toFixed(2)} m / ${pixelH} px`, 0, 0);
                ctx.restore();

                document.getElementById("info").innerHTML = `
                <strong>Resolusi Pitch:</strong> ${pitch} mm<br/>
                <strong>Ukuran LED:</strong> ${W.toFixed(2)} m x ${H.toFixed(2)} m
                (${pixelW} px x ${pixelH} px)<br/>
                <strong>Ukuran Konten 16:9:</strong> ${kontenWidth.toFixed(2)} m x ${kontenHeight.toFixed(2)} m
                (${pixelKontenW} px x ${pixelKontenH} px)
            `;
            }

            window.addEventListener("resize", () => {
                const W = parseFloat(document.getElementById("inputW").value);
                const H = parseFloat(document.getElementById("inputH").value);
                if (W && H) hitungDanGambar();
            });
        </script>
    </body>
</html>
